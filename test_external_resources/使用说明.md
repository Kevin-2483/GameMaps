# 外部资源测试包使用说明

## 测试文件结构

```
test_external_resources/
├── metadata.json              # 复杂映射格式的元数据文件
├── metadata_simple.json       # 简单映射格式的元数据文件
├── images/
│   ├── logo.png              # Logo图片 (SVG格式)
│   └── background.jpg         # 背景图片 (SVG格式)
├── configs/
│   └── settings.json          # 应用配置文件
├── data/
│   └── operators.json         # 彩虹六号干员数据
├── sounds/
│   └── notification.mp3       # 通知音效 (模拟文件)
├── docs/
│   └── readme.txt             # 说明文档
└── 使用说明.md                # 本文件
```

## 测试步骤

### 测试1: 复杂映射格式
1. 将以下文件压缩为ZIP:
   - `metadata.json` (重命名为 `metadata.json`)
   - `images/` 文件夹
   - `configs/` 文件夹
   - `data/` 文件夹
   - `sounds/` 文件夹
   - `docs/` 文件夹

2. 在R6Box中上传ZIP文件
3. 查看文件映射预览，应该显示每个文件的独立目标路径
4. 可以手动编辑目标路径或使用路径选择器
5. 确认并处理

### 测试2: 简单映射格式
1. 将以下文件压缩为ZIP:
   - `metadata_simple.json` (重命名为 `metadata.json`)
   - `images/` 文件夹
   - `configs/` 文件夹
   - `data/` 文件夹

2. 在R6Box中上传ZIP文件
3. 查看文件映射预览，所有文件应该映射到 `fs/assets/simple_resources/` 目录
4. 确认并处理

## 预期行为

### 复杂映射格式 (metadata.json)
- Logo图片 → `fs/assets/images/logo.png`
- 背景图片 → `fs/assets/images/backgrounds/main_bg.jpg`
- 配置文件 → `fs/configs/app_settings.json`
- 干员数据 → `fs/data/r6_operators.json`
- 通知音效 → `fs/assets/sounds/notification.mp3`
- 说明文档 → `fs/docs/readme.txt`

### 简单映射格式 (metadata_simple.json)
- 所有文件 → `fs/assets/simple_resources/[原文件名]`

## 功能测试点

✅ **ZIP文件解析**: 正确解压并识别文件结构
✅ **元数据验证**: 检查metadata.json是否在根目录
✅ **文件映射预览**: 显示源文件和目标路径的对应关系
✅ **路径编辑**: 手动修改目标路径
✅ **路径选择器**: 使用图形界面选择目标目录
✅ **路径验证**: 检查路径是否以'fs/'开头且不包含危险字符
✅ **文件冲突检测**: 检查目标位置是否已存在文件
✅ **文件复制**: 将文件从临时位置复制到目标位置
✅ **临时文件清理**: 处理完成后清理临时文件

## 注意事项

1. **文件格式**: 图片文件使用SVG格式以便在文本编辑器中查看
2. **音频文件**: notification.mp3是模拟文件，包含文本内容而非真实音频数据
3. **路径安全**: 只允许'fs/'开头的路径，不允许包含'..'或'//'的危险路径
4. **元数据格式**: 支持两种格式，可以分别测试不同的映射逻辑

## 故障排除

- **上传失败**: 检查ZIP文件是否包含metadata.json在根目录
- **路径验证失败**: 确保目标路径以'fs/'开头
- **文件冲突**: 选择覆盖或取消操作
- **权限错误**: 检查VFS权限设置

---

创建时间: 2024-01-15
适用版本: R6Box 1.0.0+